@using Library.DataAccess.Domain
@model Library.DataAccess.Domain.Posts

@{
    ViewData["TITLE"] = Model.TITLE;
    var totalImgs = Model.IMAGES.Count;
     var postDocs = ViewBag.PostDocs as List<PostsDocs>;
}
<header>
    <link href="https://fonts.googleapis.com/css?family=Inria+Sans&display=swap" rel="stylesheet" />
</header>
<body>
    <div class="card">
        <div class="card-body">
    <div class="post-container">
        <h1 class="post-title">@Model.TITLE</h1>
        @if (Model.IMAGES.Count > 0)
        {
            <div class="carousel-container">
                <div class="carousel-wrapper" id="carouselWrapper">
                    @foreach (var img in Model.IMAGES)
                    {
                        <div class="carousel-slide">
                            <img class="carousel-image" src="@img.PATH" alt="Post Image" onclick="openModal('@img.PATH')">
                        </div>
                    }
                </div>
                <button class="carousel-arrow carousel-arrow-left" onclick="moveCarousel(-1)">&lt;</button>
                <button class="carousel-arrow carousel-arrow-right" onclick="moveCarousel(1)">&gt;</button>
            </div>
        }
        <small class="text-muted" style="font-size: 15px;">Publicado el @Model.CREATED_AT.ToShortDateString()</small>
        <div class="post-content">
            @Html.Raw(Model.CONTENT)
        </div>

        <!-- Documentos Adjuntos Section -->
        <div class="mt-4">
            @if (postDocs != null && postDocs.Count > 0)
            {
                <h3> Documentos Adjuntos:</h3>
                <ul class="list-unstyled">
                    @foreach (var doc in postDocs)
                    {
                        <li class="mb-2">
                            <a href="@doc.Path" target="_blank" class="text-decoration-none">
                                 Descargar Documento
                            </a>
                        </li>
                    }
                </ul>
            }
            else
            {
                <p>No hay documentos adjuntos.</p>
            }
        </div>
    </div>
    

    <!-- Image Modal -->
    <div id="imageModal" class="modal" onclick="closeModal()">
        <span class="modal-close">&times;</span>
        <img class="modal-content" id="modalImage">
    </div>

    <!-- Back Button -->
    <div class="text-center mt-4">
        <a asp-controller="Posts" asp-action="Index" class="btn btn-secondary">
            <i class="fas fa-arrow-left"></i> Volver a Publicaciones
        </a>
    </div>
    </div>
    </div>
</body>

<style>
    body {
        font-family: 'Inria Sans', sans-serif;
    }

    .post-container {
        margin: 20px auto;
        width: 80%;
        max-width: 900px;
        padding: 16px;
    }

    .post-title {
        text-align: center;
        font-size: 32px;
        font-weight: bold;
        margin-bottom: 20px;
    }

    .carousel-container {
        position: relative;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
        width: 100%;
        height: 400px;
        background-color: #f8f8f8;
        border-radius: 8px;
        margin-bottom: 20px;
    }

    .carousel-wrapper {
        display: flex;
        transition: transform 0.5s ease;
        height: 100%;
    }

    .carousel-slide {
        flex: 0 0 100%;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .carousel-image {
        max-width: 100%;
        max-height: 100%;
        object-fit: contain;
        border-radius: 4px;
        cursor: pointer;
        transition: transform 0.3s ease;
    }

    .carousel-image:hover {
        transform: scale(1.05);
    }

    .carousel-arrow {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 40px;
        height: 40px;
        background: rgba(0, 0, 0, 0.6);
        color: white;
        border: none;
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        z-index: 10;
        font-size: 20px;
        transition: background 0.3s;
    }

    .carousel-arrow:hover {
        background: rgba(0, 0, 0, 0.9);
    }

    .carousel-arrow-left {
        left: 10px;
    }

    .carousel-arrow-right {
        right: 10px;
    }

    .post-content {
        padding: 16px;
    }

    /* Estilo para el modal */
    .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.8);
        justify-content: center;
        align-items: center;
    }

    .modal-content {
        margin: auto;
        display: block;
        max-width: 90%;
        max-height: 80%;
        border-radius: 4px;
        object-fit: contain;
        background-color: #bbbbbb00;
    }

    .modal-close {
        position: absolute;
        top: 20px;
        right: 30px;
        color: white;
        font-size: 35px;
        font-weight: bold;
        cursor: pointer;
    }

    .modal-close:hover,
    .modal-close:focus {
        color: #bbb;
    }
</style>

<script>
    let currentSlide = 0;
    const totalImages = @totalImgs;
    const carouselWrapper = document.getElementById('carouselWrapper');
    const modal = document.getElementById('imageModal');
    const modalImage = document.getElementById('modalImage');

    // Funci贸n para mover el carrusel
    function moveCarousel(direction) {
        currentSlide += direction;

        // Ajustar la l贸gica para evitar exceder los l铆mites
        if (currentSlide < 0) {
            currentSlide = totalImages - 1;
        } else if (currentSlide >= totalImages) {
            currentSlide = 0;
        }

        // Mover el carrusel
        carouselWrapper.style.transform = `translateX(-${currentSlide * 100}%)`;
    }

    // Funci贸n para abrir el modal con la imagen seleccionada
    function openModal(imagePath) {
        modal.style.display = "flex";
        modalImage.src = imagePath;
    }

    // Funci贸n para cerrar el modal
    function closeModal() {
        modal.style.display = "none";
    }

  
   document.querySelector('.main-content').classList.remove('with-menu');
   document.querySelector('.main-content').classList.add('full-width');

</script>
<script>
    document.querySelector('.main-content').classList.remove('with-menu');
    document.querySelector('.main-content').classList.add('full-width');
</script>
